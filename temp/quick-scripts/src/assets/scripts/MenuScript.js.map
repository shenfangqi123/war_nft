{"version":3,"sources":["assets/scripts/MenuScript.js"],"names":["cc","Class","Component","properties","loading","ProgressBar","loadLabel","Label","onLoad","start","onProgress","completedCount","totalCount","item","progress","string","Math","floor","goRelay","event","customEventData","isShared","shareTag","closeTime","Date","getTime","CC_WECHATGAME","wx","shareAppMessage","title","imageUrl","play","buffType","videoAd","createRewardedVideoAd","adUnitId","show","load","then","err","console","log","onError","goGame","onClose","res","isEnded","undefined","selLayout","getSelLayoutNode","selLayoutNode","getComponent","myAgentsParam","getNowAgents","curTime","onSceneLaunched","gameObj","director","getScene","getChildByName","gameNode","setBuffDisp","setParam","loadScene","node"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // foo: {\n        //     // ATTRIBUTES:\n        //     default: null,        // The default value will be used only when the component attaching\n        //                           // to a node for the first time\n        //     type: cc.SpriteFrame, // optional, default is typeof default\n        //     serializable: true,   // optional, default is true\n        // },\n        // bar: {\n        //     get () {\n        //         return this._bar;\n        //     },\n        //     set (value) {\n        //         this._bar = value;\n        //     }\n        // },\n\n        loading: cc.ProgressBar,\n        loadLabel: cc.Label,\n\n        //audioMng: cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        //this.audioMng = this.audioMng.getComponent('AudioMng');\n        //this.audioMng.playMusic();\n    },\n\n    start () {\n    },\n\n    onProgress: function(completedCount, totalCount, item){\n        //console.log( Math.floor(completedCount/totalCount * 100) + \"%\");\n        this.loading.progress = completedCount/totalCount;\n        this.loadLabel.string = Math.floor(completedCount/totalCount * 100) + \"%\";\n    },\n\n    goRelay: function(event, customEventData) {\n        this.isShared = true;\n        this.shareTag = customEventData;\n        this.closeTime = new Date().getTime();\n        if (CC_WECHATGAME) {    //if wechat platform\n            wx.shareAppMessage({\n                title: \"中古战纪\",\n                imageUrl: \"https://www.asobee.mobi/fftower/res/acLogo2.jpg\"\n            })\n        }\n    },\n\n    play: function(event, customEventData) {\n        var buffType = customEventData;\n\n        if(CC_WECHATGAME && (buffType == \"heal\" || buffType == \"thunder\")) {\n            // 创建激励视频广告实例，提前初始化\n            let videoAd = wx.createRewardedVideoAd({\n                adUnitId: 'adunit-ebd5d981ced848c7'\n            });\n\n            // 用户触发广告后，显示激励视频广告\n            videoAd.show().catch(() => {\n                // 失败重试\n                videoAd.load()\n                    .then(() => videoAd.show())\n                    .catch(err => {\n                      console.log('激励视频 广告显示失败')\n                    })\n            });\n\n            videoAd.onError(() => {\n                console.log('激励视频 广告加载失败');\n                this.goGame(buffType);\n            });\n\n            videoAd.onClose(res => {\n                // 用户点击了【关闭广告】按钮\n                // 小于 2.1.0 的基础库版本，res 是一个 undefined\n                if (res && res.isEnded || res === undefined) {\n                    //cc.director.loadScene('game', onSceneLaunched);\n                    this.goGame(buffType);\n                }\n            });\n        } else {\n            //cc.director.loadScene('game', onSceneLaunched);\n            this.goGame(buffType);\n        }\n    },\n\n    goGame: function(buffType) {\n        var selLayout = this.getSelLayoutNode();\n        var selLayoutNode = selLayout.getComponent(\"SelLayout\");\n        var myAgentsParam = selLayoutNode.getNowAgents();\n        var curTime = new Date().getTime();\n\n        var onSceneLaunched = function() {\n            console.log(\"--ss1---\");\n            console.log(myAgentsParam);\n            var gameObj = cc.director.getScene().getChildByName('Canvas').getChildByName('layout');\n            var gameNode = gameObj.getComponent('Game');\n            gameNode.setBuffDisp(buffType);\n            gameNode.setParam(myAgentsParam, curTime);\n        };\n\n        cc.director.loadScene('game', onSceneLaunched);\n    },\n\n    getSelLayoutNode: function() {\n        var selLayout = this.node.getChildByName(\"SelScrollView\").getChildByName(\"view\").getChildByName(\"content\").getChildByName(\"SelLayout\");\n        return selLayout;\n    },\n\n    // update (dt) {},\n});\n"]}