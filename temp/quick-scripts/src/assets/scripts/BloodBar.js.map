{"version":3,"sources":["assets/scripts/BloodBar.js"],"names":["String","prototype","startWith","str","reg","RegExp","test","cc","Class","Component","properties","hp","barWidth","upToHead","level","role","onLoad","node","active","setBarWidth","isBase","setLoc","parent","height","isFort1","bar","getChildByName","width","x","_name","spName","px","py","moveTo","v2","setPosition","setBarLevel","val","undefined","getComponent","Label","string","setBloodBar","life","totalLife","barTotalWidth","color","Color"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\nString.prototype.startWith=function(str){    \n  var reg=new RegExp(\"^\"+str);    \n  return reg.test(this);       \n} \n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        hp:-1,\n        barWidth:50,\n        upToHead:30,\n        level:1,\n        role:\"\",\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.node.active = false;\n        this.setBarWidth();\n        if(this.isBase()) {\n            this.setLoc(0, this.node.parent.height/2+20);\n        } \n        else if(this.isFort1()) {\n            this.setLoc(0, this.node.parent.height/2+60);\n        } \n        else {\n            this.setLoc(0, this.node.parent.height);            \n        }\n    },\n\n    //start () {},\n\n    setBarWidth: function() {\n        var bar = this.node.getChildByName(\"bar\");\n        var level = this.node.getChildByName(\"level\");\n\n        if(this.isBase()) {\n            this.node.width = 80;\n        } \n        else if(this.isFort1()) {\n            this.node.width = 50;\n        } \n        else {\n            this.node.width = 30;\n        }\n\n        bar.x = this.node.width/2*-1;\n        level.x = bar.x - 5;\n    },\n\n    isBase: function() {\n        if(this.node.parent._name.startWith(\"base\")) {\n            return true;\n        }\n        return false;\n    },\n\n    isFort1: function() {\n        if(this.node.parent.spName == \"FortASprite\") {\n            return true;\n        }\n        return false;\n    },\n\n    setLoc: function(px, py) {\n        var moveTo = cc.v2(px, py);\n        this.node.setPosition(moveTo);\n    },\n\n    setBarLevel: function(val) {\n        if(val === undefined) {\n            val = 1;\n        }\n\n        var level = this.node.getChildByName(\"level\");\n        level.getComponent(cc.Label).string = val;\n    },\n\n    setBloodBar: function(life, totalLife) {\n        if(life < totalLife) {\n            this.node.active = true;\n        }\n        var bar = this.node.getChildByName(\"bar\");\n        var barTotalWidth = this.node.width;\n        bar.width = life/totalLife * barTotalWidth;\n\n        if(life < totalLife * 0.35) {\n            bar.color = new cc.Color(250,0,0);\n        } else {\n            bar.color = new cc.Color(50,250,0);            \n        }\n    },\n\n    // update (dt) {},\n});\n"]}