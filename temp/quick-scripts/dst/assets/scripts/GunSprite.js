
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/scripts/GunSprite.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, '2fe15M3k5hEtLqG347kT1t6', 'GunSprite');
// scripts/GunSprite.js

"use strict";

var common = require("Common"); // Learn cc.Class:
//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html
//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html
// Learn Attribute:
//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html
//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html
// Learn life-cycle callbacks:
//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html
//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html


cc.Class({
  "extends": cc.Component,
  properties: {
    role: "gun"
  },
  // LIFE-CYCLE CALLBACKS:
  // onLoad () {},
  start: function start() {
    this._animation = this.getComponent(cc.Animation);
    this._animation.WrapMode = cc.WrapMode.Loop;
  },
  isEnemyBase: function isEnemyBase(baseId) {
    if (baseId == 1 || baseId == 2 || baseId == 3) {
      return true;
    } else {
      return false;
    }
  },
  playBaseWarriorAnimationDefault: function playBaseWarriorAnimationDefault(actType, isMainPlayer, baseId) {
    var actName;

    if (this.isEnemyBase(baseId)) {
      actName = "ar_s_walk";
    } else {
      actName = "ar_n_walk";
    }

    if (actType == "move" && this.lastAct == actName) {
      return;
    }

    var randomTime = Math.ceil(Math.random() * 125) / 100;

    this._animation.play(actName, randomTime);

    this.lastAct = actName;
  },
  playBaseWarriorAnimation: function playBaseWarriorAnimation(agent, isMainPlayer, actType) {
    var fx, fy;
    var targetYOffset = common.attackTargetYOffset;
    var ex, ey;
    var angle;
    var x = agent.mypos.x;
    var y = agent.mypos.y; //gun is located on the up&down inside base, 
    //but default attack point is in the central of the base, so angle may need to ajust.

    if (agent.objectId == 1) {
      y = agent.mypos.y + 1;
    } else if (agent.objectId == 4) {
      y = agent.mypos.y - 0;
    }

    var startPos, targetPos, startEPos, targetEPos, vt, vtE;
    var randomTime = Math.ceil(Math.random() * 125) / 100;
    var actName = "";
    var then;
    var angleInfo; // user to control the up and down user Y postion offset.

    var offsetDir = 1;

    if (isMainPlayer == 1) {
      offsetDir = 1;
    } else if (isMainPlayer == 2) {
      offsetDir = -1;
    }

    ex = agent.enemypos.x;
    ey = agent.enemypos.y; // dir according to enemy position

    startPos = cc.v2(x * 30, y * 30); //targetPos = cc.v2((ex)*30, (ey)*30+targetYOffset*offsetDir);

    targetPos = cc.v2(ex * 30, ey * 30);
    vt = startPos.sub(targetPos);

    if (vt.x == 0 && vt.y == 0) {
      return;
    } //if postion not changed, do nothing, or the math.atan will do error.


    if (vt.x != 0 && vt.y != 0) {
      var ag = 180 / Math.PI * Math.atan(vt.x / vt.y);
      angle = ag; //if base is up, left right angle should be ajusted.

      if (vt.y >= 0 && vt.x < 0) {
        angle = ag + 180;
      } else if (vt.y >= 0 && vt.x >= 0) {
        angle = ag - 180;
      }
    }

    if (this._animation) {
      console.log(angle);
      angleInfo = this.getActnameByAngle(angle, actType);
      actName = angleInfo.actName; //used to mirror a sprite.

      this.node.scaleX = angleInfo.scaleX; //if already in attack mode, just skip the animation

      if (this.lastAct != actName || actType == "sa") {
        if (actType == "sa") {
          this._animation.stop();

          this._animation.play(actName);
        } else {
          //walking action.
          this._animation.play(actName, randomTime);
        }

        this.angle = angle;
        this.lastAct = actName;
        this.lastScaleX = angleInfo.scaleX;
      }
    }
  },
  getActnameByAngle: function getActnameByAngle(angle, actType) {
    var actName = "";
    var scaleX = 1;
    var ret = {};

    if (angle >= 0 && angle <= 7.5 * 1) {
      if (actType == "move") {
        actName = "n_walk";
      } else if (actType == "sa") {
        actName = "n_attack";
      }
    } else if (angle > 7.5 * 1 && angle <= 7.5 * 3) {
      if (actType == "move") {
        actName = "en5_walk";
      } else if (actType == "sa") {
        actName = "en5_attack";
      }
    } else if (angle > 7.5 * 3 && angle <= 7.5 * 5) {
      if (actType == "move") {
        actName = "en4_walk";
      } else if (actType == "sa") {
        actName = "en4_attack";
      }
    } else if (angle > 7.5 * 5 && angle <= 7.5 * 7) {
      if (actType == "move") {
        actName = "en3_walk";
      } else if (actType == "sa") {
        actName = "en3_attack";
      }
    } else if (angle > 7.5 * 7 && angle <= 7.5 * 9) {
      if (actType == "move") {
        actName = "en2_walk";
      } else if (actType == "sa") {
        actName = "en2_attack";
      }
    } else if (angle > 7.5 * 9 && angle <= 7.5 * 11) {
      if (actType == "move") {
        actName = "en1_walk";
      } else if (actType == "sa") {
        actName = "en1_attack";
      }
    } else if (angle > 7.5 * 11 && angle <= 7.5 * 13) {
      if (actType == "move") {
        actName = "e_walk";
      } else if (actType == "sa") {
        actName = "e_attack";
      }
    } else if (angle > 7.5 * 13 && angle <= 7.5 * 15) {
      if (actType == "move") {
        actName = "se1_walk";
      } else if (actType == "sa") {
        actName = "se1_attack";
      }
    } else if (angle > 7.5 * 15 && angle <= 7.5 * 17) {
      if (actType == "move") {
        actName = "se2_walk";
      } else if (actType == "sa") {
        actName = "se2_attack";
      }
    } else if (angle > 7.5 * 17 && angle <= 7.5 * 19) {
      if (actType == "move") {
        actName = "se3_walk";
      } else if (actType == "sa") {
        actName = "se3_attack";
      }
    } else if (angle > 7.5 * 19 && angle <= 7.5 * 21) {
      if (actType == "move") {
        actName = "se4_walk";
      } else if (actType == "sa") {
        actName = "se4_attack";
      }
    } else if (angle > 7.5 * 21 && angle <= 7.5 * 23) {
      if (actType == "move") {
        actName = "se5_walk";
      } else if (actType == "sa") {
        actName = "se5_attack";
      }
    } else if (angle > 7.5 * 21 && angle <= 7.5 * 23) {
      if (actType == "move") {
        actName = "s_walk";
      } else if (actType == "sa") {
        actName = "s_attack";
      }
    } else if (angle < 0 && angle >= 7.5 * -1) {
      if (actType == "move") {
        actName = "n_walk";
      } else if (actType == "sa") {
        actName = "n_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -1 && angle >= 7.5 * -3) {
      if (actType == "move") {
        actName = "en5_walk";
      } else if (actType == "sa") {
        actName = "en5_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -3 && angle >= 7.5 * -5) {
      if (actType == "move") {
        actName = "en4_walk";
      } else if (actType == "sa") {
        actName = "en4_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -5 && angle >= 7.5 * -7) {
      if (actType == "move") {
        actName = "en3_walk";
      } else if (actType == "sa") {
        actName = "en3_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -7 && angle >= 7.5 * -9) {
      if (actType == "move") {
        actName = "en2_walk";
      } else if (actType == "sa") {
        actName = "en2_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -9 && angle >= 7.5 * -11) {
      if (actType == "move") {
        actName = "en1_walk";
      } else if (actType == "sa") {
        actName = "en1_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -11 && angle >= 7.5 * -13) {
      if (actType == "move") {
        actName = "e_walk";
      } else if (actType == "sa") {
        actName = "e_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -13 && angle >= 7.5 * -15) {
      if (actType == "move") {
        actName = "se1_walk";
      } else if (actType == "sa") {
        actName = "se1_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -15 && angle >= 7.5 * -17) {
      if (actType == "move") {
        actName = "se2_walk";
      } else if (actType == "sa") {
        actName = "se2_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -17 && angle >= 7.5 * -19) {
      if (actType == "move") {
        actName = "se3_walk";
      } else if (actType == "sa") {
        actName = "se3_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -19 && angle >= 7.5 * -21) {
      if (actType == "move") {
        actName = "se4_walk";
      } else if (actType == "sa") {
        actName = "se4_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -21 && angle >= 7.5 * -23) {
      if (actType == "move") {
        actName = "se5_walk";
      } else if (actType == "sa") {
        actName = "se5_attack";
      }

      scaleX = -1;
    } else if (angle < 7.5 * -23) {
      if (actType == "move") {
        actName = "s_walk";
      } else if (actType == "sa") {
        actName = "s_attack";
      }

      scaleX = -1;
    } else {
      console.log("------:" + angle);
    }

    actName = this.role + "_" + actName;
    ret.actName = actName;
    ret.scaleX = scaleX;
    return ret;
  } // update (dt) {},

});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0cy9zY3JpcHRzL0d1blNwcml0ZS5qcyJdLCJuYW1lcyI6WyJjb21tb24iLCJyZXF1aXJlIiwiY2MiLCJDbGFzcyIsIkNvbXBvbmVudCIsInByb3BlcnRpZXMiLCJyb2xlIiwic3RhcnQiLCJfYW5pbWF0aW9uIiwiZ2V0Q29tcG9uZW50IiwiQW5pbWF0aW9uIiwiV3JhcE1vZGUiLCJMb29wIiwiaXNFbmVteUJhc2UiLCJiYXNlSWQiLCJwbGF5QmFzZVdhcnJpb3JBbmltYXRpb25EZWZhdWx0IiwiYWN0VHlwZSIsImlzTWFpblBsYXllciIsImFjdE5hbWUiLCJsYXN0QWN0IiwicmFuZG9tVGltZSIsIk1hdGgiLCJjZWlsIiwicmFuZG9tIiwicGxheSIsInBsYXlCYXNlV2FycmlvckFuaW1hdGlvbiIsImFnZW50IiwiZngiLCJmeSIsInRhcmdldFlPZmZzZXQiLCJhdHRhY2tUYXJnZXRZT2Zmc2V0IiwiZXgiLCJleSIsImFuZ2xlIiwieCIsIm15cG9zIiwieSIsIm9iamVjdElkIiwic3RhcnRQb3MiLCJ0YXJnZXRQb3MiLCJzdGFydEVQb3MiLCJ0YXJnZXRFUG9zIiwidnQiLCJ2dEUiLCJ0aGVuIiwiYW5nbGVJbmZvIiwib2Zmc2V0RGlyIiwiZW5lbXlwb3MiLCJ2MiIsInN1YiIsImFnIiwiUEkiLCJhdGFuIiwiY29uc29sZSIsImxvZyIsImdldEFjdG5hbWVCeUFuZ2xlIiwibm9kZSIsInNjYWxlWCIsInN0b3AiLCJsYXN0U2NhbGVYIiwicmV0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUlBLE1BQU0sR0FBR0MsT0FBTyxDQUFDLFFBQUQsQ0FBcEIsRUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBQyxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsSUFBSSxFQUFDO0FBREcsR0FI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QUFDSDs7QUFDRHVDLE1BQUFBLE1BQU0sR0FBRyxDQUFDLENBQVY7QUFDSCxLQVJJLE1BU0EsSUFBR3hCLEtBQUssR0FBQyxNQUFJLENBQUMsRUFBWCxJQUFpQkEsS0FBSyxJQUFFLE1BQUksQ0FBQyxFQUFoQyxFQUFvQztBQUNyQyxVQUFHakIsT0FBTyxJQUFJLE1BQWQsRUFBc0I7QUFDbEJFLFFBQUFBLE9BQU8sR0FBRyxVQUFWO0FBQ0gsT0FGRCxNQUdLLElBQUdGLE9BQU8sSUFBSSxJQUFkLEVBQW9CO0FBQ3JCRSxRQUFBQSxPQUFPLEdBQUcsWUFBVjtBQUNIOztBQUNEdUMsTUFBQUEsTUFBTSxHQUFHLENBQUMsQ0FBVjtBQUNILEtBUkksTUFTQSxJQUFHeEIsS0FBSyxHQUFDLE1BQUksQ0FBQyxFQUFkLEVBQWtCO0FBQ25CLFVBQUdqQixPQUFPLElBQUksTUFBZCxFQUFzQjtBQUNsQkUsUUFBQUEsT0FBTyxHQUFHLFFBQVY7QUFDSCxPQUZELE1BR0ssSUFBR0YsT0FBTyxJQUFJLElBQWQsRUFBb0I7QUFDckJFLFFBQUFBLE9BQU8sR0FBRyxVQUFWO0FBQ0g7O0FBQ0R1QyxNQUFBQSxNQUFNLEdBQUcsQ0FBQyxDQUFWO0FBQ0gsS0FSSSxNQVVBO0FBQ0RKLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFlBQVVyQixLQUF0QjtBQUNIOztBQUVEZixJQUFBQSxPQUFPLEdBQUcsS0FBS1osSUFBTCxHQUFXLEdBQVgsR0FBZ0JZLE9BQTFCO0FBRUEwQyxJQUFBQSxHQUFHLENBQUMxQyxPQUFKLEdBQWNBLE9BQWQ7QUFDQTBDLElBQUFBLEdBQUcsQ0FBQ0gsTUFBSixHQUFhQSxNQUFiO0FBQ0EsV0FBT0csR0FBUDtBQUNILEdBL1dJLENBaVhMOztBQWpYSyxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY29tbW9uID0gcmVxdWlyZShcIkNvbW1vblwiKTtcblxuLy8gTGVhcm4gY2MuQ2xhc3M6XG4vLyAgLSBbQ2hpbmVzZV0gaHR0cDovL2RvY3MuY29jb3MuY29tL2NyZWF0b3IvbWFudWFsL3poL3NjcmlwdGluZy9jbGFzcy5odG1sXG4vLyAgLSBbRW5nbGlzaF0gaHR0cDovL3d3dy5jb2NvczJkLXgub3JnL2RvY3MvY3JlYXRvci9lbi9zY3JpcHRpbmcvY2xhc3MuaHRtbFxuLy8gTGVhcm4gQXR0cmlidXRlOlxuLy8gIC0gW0NoaW5lc2VdIGh0dHA6Ly9kb2NzLmNvY29zLmNvbS9jcmVhdG9yL21hbnVhbC96aC9zY3JpcHRpbmcvcmVmZXJlbmNlL2F0dHJpYnV0ZXMuaHRtbFxuLy8gIC0gW0VuZ2xpc2hdIGh0dHA6Ly93d3cuY29jb3MyZC14Lm9yZy9kb2NzL2NyZWF0b3IvZW4vc2NyaXB0aW5nL3JlZmVyZW5jZS9hdHRyaWJ1dGVzLmh0bWxcbi8vIExlYXJuIGxpZmUtY3ljbGUgY2FsbGJhY2tzOlxuLy8gIC0gW0NoaW5lc2VdIGh0dHA6Ly9kb2NzLmNvY29zLmNvbS9jcmVhdG9yL21hbnVhbC96aC9zY3JpcHRpbmcvbGlmZS1jeWNsZS1jYWxsYmFja3MuaHRtbFxuLy8gIC0gW0VuZ2xpc2hdIGh0dHA6Ly93d3cuY29jb3MyZC14Lm9yZy9kb2NzL2NyZWF0b3IvZW4vc2NyaXB0aW5nL2xpZmUtY3ljbGUtY2FsbGJhY2tzLmh0bWxcblxuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgcm9sZTpcImd1blwiLFxuICAgIH0sXG5cbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcblxuICAgIC8vIG9uTG9hZCAoKSB7fSxcblxuICAgIHN0YXJ0ICgpIHtcbiAgICAgICAgdGhpcy5fYW5pbWF0aW9uID0gdGhpcy5nZXRDb21wb25lbnQoY2MuQW5pbWF0aW9uKTtcbiAgICAgICAgdGhpcy5fYW5pbWF0aW9uLldyYXBNb2RlID0gY2MuV3JhcE1vZGUuTG9vcDtcbiAgICB9LFxuXG4gICAgaXNFbmVteUJhc2U6IGZ1bmN0aW9uKGJhc2VJZCkge1xuICAgICAgICBpZihiYXNlSWQgPT0gMSB8fCBiYXNlSWQgPT0gMiB8fCBiYXNlSWQgPT0gMykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgcGxheUJhc2VXYXJyaW9yQW5pbWF0aW9uRGVmYXVsdDogZnVuY3Rpb24oYWN0VHlwZSwgaXNNYWluUGxheWVyLCBiYXNlSWQpIHtcbiAgICAgICAgdmFyIGFjdE5hbWU7XG5cbiAgICAgICAgaWYodGhpcy5pc0VuZW15QmFzZShiYXNlSWQpKSB7XG4gICAgICAgICAgICBhY3ROYW1lID0gXCJhcl9zX3dhbGtcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFjdE5hbWUgPSBcImFyX25fd2Fsa1wiO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIiAmJiB0aGlzLmxhc3RBY3QgPT0gYWN0TmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciByYW5kb21UaW1lID0gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkqMTI1KS8xMDA7XG4gICAgICAgIHRoaXMuX2FuaW1hdGlvbi5wbGF5KGFjdE5hbWUsIHJhbmRvbVRpbWUpO1xuICAgICAgICB0aGlzLmxhc3RBY3QgPSBhY3ROYW1lO1xuICAgIH0sXG5cbiAgICBwbGF5QmFzZVdhcnJpb3JBbmltYXRpb246IGZ1bmN0aW9uKGFnZW50LCBpc01haW5QbGF5ZXIsIGFjdFR5cGUpIHtcbiAgICAgICAgdmFyIGZ4LGZ5O1xuICAgICAgICB2YXIgdGFyZ2V0WU9mZnNldCA9IGNvbW1vbi5hdHRhY2tUYXJnZXRZT2Zmc2V0O1xuICAgICAgICB2YXIgZXgsIGV5O1xuICAgICAgICB2YXIgYW5nbGU7XG4gICAgICAgIHZhciB4ID0gYWdlbnQubXlwb3MueDsgXG4gICAgICAgIHZhciB5ID0gYWdlbnQubXlwb3MueTtcblxuICAgICAgICAvL2d1biBpcyBsb2NhdGVkIG9uIHRoZSB1cCZkb3duIGluc2lkZSBiYXNlLCBcbiAgICAgICAgLy9idXQgZGVmYXVsdCBhdHRhY2sgcG9pbnQgaXMgaW4gdGhlIGNlbnRyYWwgb2YgdGhlIGJhc2UsIHNvIGFuZ2xlIG1heSBuZWVkIHRvIGFqdXN0LlxuICAgICAgICBpZihhZ2VudC5vYmplY3RJZCA9PSAxKSB7XG4gICAgICAgICAgICB5ID0gYWdlbnQubXlwb3MueSsxOyBcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFnZW50Lm9iamVjdElkID09IDQpIHtcbiAgICAgICAgICAgIHkgPSBhZ2VudC5teXBvcy55LTA7IFxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHN0YXJ0UG9zLHRhcmdldFBvcyxzdGFydEVQb3MsIHRhcmdldEVQb3MsIHZ0LCB2dEU7XG5cbiAgICAgICAgdmFyIHJhbmRvbVRpbWUgPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSoxMjUpLzEwMDtcbiAgICAgICAgdmFyIGFjdE5hbWUgPSBcIlwiO1xuICAgICAgICB2YXIgdGhlbjtcbiAgICAgICAgdmFyIGFuZ2xlSW5mbztcblxuICAgICAgICAvLyB1c2VyIHRvIGNvbnRyb2wgdGhlIHVwIGFuZCBkb3duIHVzZXIgWSBwb3N0aW9uIG9mZnNldC5cbiAgICAgICAgdmFyIG9mZnNldERpciA9IDE7XG5cbiAgICAgICAgaWYoaXNNYWluUGxheWVyID09IDEpIHtcbiAgICAgICAgICAgIG9mZnNldERpciA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihpc01haW5QbGF5ZXIgPT0gMikge1xuICAgICAgICAgICAgb2Zmc2V0RGlyID0gLTE7XG4gICAgICAgIH1cblxuICAgICAgICBleCA9IGFnZW50LmVuZW15cG9zLng7IFxuICAgICAgICBleSA9IGFnZW50LmVuZW15cG9zLnk7IFxuXG4gICAgICAgIC8vIGRpciBhY2NvcmRpbmcgdG8gZW5lbXkgcG9zaXRpb25cbiAgICAgICAgc3RhcnRQb3MgID0gY2MudjIoKHgpKjMwLCAoeSkqMzApO1xuICAgICAgICAvL3RhcmdldFBvcyA9IGNjLnYyKChleCkqMzAsIChleSkqMzArdGFyZ2V0WU9mZnNldCpvZmZzZXREaXIpO1xuICAgICAgICB0YXJnZXRQb3MgPSBjYy52MigoZXgpKjMwLCAoZXkpKjMwKTtcbiAgICAgICAgdnQgPSBzdGFydFBvcy5zdWIodGFyZ2V0UG9zKTtcblxuICAgICAgICBpZih2dC54ID09IDAgJiYgdnQueSA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvL2lmIHBvc3Rpb24gbm90IGNoYW5nZWQsIGRvIG5vdGhpbmcsIG9yIHRoZSBtYXRoLmF0YW4gd2lsbCBkbyBlcnJvci5cbiAgICAgICAgaWYodnQueCAhPSAwICYmIHZ0LnkgIT0gMCkge1xuICAgICAgICAgICAgdmFyIGFnID0gMTgwL01hdGguUEkgKiBNYXRoLmF0YW4odnQueC92dC55KTtcbiAgICAgICAgICAgIGFuZ2xlID0gYWc7XG5cbiAgICAgICAgICAgIC8vaWYgYmFzZSBpcyB1cCwgbGVmdCByaWdodCBhbmdsZSBzaG91bGQgYmUgYWp1c3RlZC5cbiAgICAgICAgICAgIGlmKHZ0LnkgPj0gMCAmJiB2dC54IDwgMCkge1xuICAgICAgICAgICAgICAgIGFuZ2xlID0gYWcgKyAxODA7XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgZWxzZSBpZih2dC55ID49IDAgJiYgdnQueCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgYW5nbGUgPSBhZyAtIDE4MDtcbiAgICAgICAgICAgIH0gXG4gICAgICAgIH1cblxuICAgICAgICBpZih0aGlzLl9hbmltYXRpb24pIHtcbmNvbnNvbGUubG9nKGFuZ2xlKTtcbiAgICAgICAgICAgIGFuZ2xlSW5mbyA9IHRoaXMuZ2V0QWN0bmFtZUJ5QW5nbGUoYW5nbGUsIGFjdFR5cGUpO1xuICAgICAgICAgICAgYWN0TmFtZSA9IGFuZ2xlSW5mby5hY3ROYW1lO1xuXG4gICAgICAgICAgICAvL3VzZWQgdG8gbWlycm9yIGEgc3ByaXRlLlxuICAgICAgICAgICAgdGhpcy5ub2RlLnNjYWxlWCA9IGFuZ2xlSW5mby5zY2FsZVg7XG5cbiAgICAgICAgICAgIC8vaWYgYWxyZWFkeSBpbiBhdHRhY2sgbW9kZSwganVzdCBza2lwIHRoZSBhbmltYXRpb25cbiAgICAgICAgICAgIGlmKHRoaXMubGFzdEFjdCAhPSBhY3ROYW1lIHx8IGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0aW9uLnN0b3AoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0aW9uLnBsYXkoYWN0TmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy93YWxraW5nIGFjdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYW5pbWF0aW9uLnBsYXkoYWN0TmFtZSwgcmFuZG9tVGltZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuYW5nbGUgPSBhbmdsZTtcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RBY3QgPSBhY3ROYW1lO1xuICAgICAgICAgICAgICAgIHRoaXMubGFzdFNjYWxlWCA9IGFuZ2xlSW5mby5zY2FsZVg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgZ2V0QWN0bmFtZUJ5QW5nbGU6IGZ1bmN0aW9uKGFuZ2xlLCBhY3RUeXBlKSB7XG4gICAgICAgIHZhciBhY3ROYW1lPVwiXCI7XG4gICAgICAgIHZhciBzY2FsZVggPSAxO1xuICAgICAgICB2YXIgcmV0ID0ge307XG5cbiAgICAgICAgaWYoYW5nbGU+PTAgJiYgYW5nbGU8PTcuNSoxKSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwibl93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwibl9hdHRhY2tcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPjcuNSoxICYmIGFuZ2xlPD03LjUqMykge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcImVuNV93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW41X2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYW5nbGU+Ny41KjMgJiYgYW5nbGU8PTcuNSo1KSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW40X3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlbjRfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihhbmdsZT43LjUqNSAmJiBhbmdsZTw9Ny41KjcpIHtcbiAgICAgICAgICAgIGlmKGFjdFR5cGUgPT0gXCJtb3ZlXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlbjNfd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcImVuM19hdHRhY2tcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPjcuNSo3ICYmIGFuZ2xlPD03LjUqOSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcImVuMl93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW4yX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYW5nbGU+Ny41KjkgJiYgYW5nbGU8PTcuNSoxMSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcImVuMV93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW4xX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuXG4gICAgICAgIGVsc2UgaWYoYW5nbGU+Ny41KjExICYmIGFuZ2xlPD03LjUqMTMpIHtcbiAgICAgICAgICAgIGlmKGFjdFR5cGUgPT0gXCJtb3ZlXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlX3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYW5nbGU+Ny41KjEzICYmIGFuZ2xlPD03LjUqMTUpIHtcbiAgICAgICAgICAgIGlmKGFjdFR5cGUgPT0gXCJtb3ZlXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJzZTFfd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlMV9hdHRhY2tcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPjcuNSoxNSAmJiBhbmdsZTw9Ny41KjE3KSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2UyX3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJzZTJfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihhbmdsZT43LjUqMTcgJiYgYW5nbGU8PTcuNSoxOSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlM193YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2UzX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYW5nbGU+Ny41KjE5ICYmIGFuZ2xlPD03LjUqMjEpIHtcbiAgICAgICAgICAgIGlmKGFjdFR5cGUgPT0gXCJtb3ZlXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJzZTRfd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlNF9hdHRhY2tcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPjcuNSoyMSAmJiBhbmdsZTw9Ny41KjIzKSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2U1X3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJzZTVfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihhbmdsZT43LjUqMjEgJiYgYW5nbGU8PTcuNSoyMykge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNfd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDAgJiYgYW5nbGU+PTcuNSotMSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcIm5fd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcIm5fYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDcuNSotMSAmJiBhbmdsZT49Ny41Ki0zKSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW41X3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlbjVfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDcuNSotMyAmJiBhbmdsZT49Ny41Ki01KSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW40X3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlbjRfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDcuNSotNSAmJiBhbmdsZT49Ny41Ki03KSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW4zX3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlbjNfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDcuNSotNyAmJiBhbmdsZT49Ny41Ki05KSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW4yX3dhbGtcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYWN0VHlwZSA9PSBcInNhXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJlbjJfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDcuNSotOSAmJiBhbmdsZT49Ny41Ki0xMSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcImVuMV93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZW4xX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NhbGVYID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZihhbmdsZTw3LjUqLTExICYmIGFuZ2xlPj03LjUqLTEzKSB7XG4gICAgICAgICAgICBpZihhY3RUeXBlID09IFwibW92ZVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZV93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwiZV9hdHRhY2tcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNjYWxlWCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYW5nbGU8Ny41Ki0xMyAmJiBhbmdsZT49Ny41Ki0xNSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlMV93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2UxX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmKGFuZ2xlPDcuNSotMTUgJiYgYW5nbGU+PTcuNSotMTcpIHtcbiAgICAgICAgICAgIGlmKGFjdFR5cGUgPT0gXCJtb3ZlXCIpIHtcbiAgICAgICAgICAgICAgICBhY3ROYW1lID0gXCJzZTJfd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlMl9hdHRhY2tcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNjYWxlWCA9IC0xO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYoYW5nbGU8Ny41Ki0xNyAmJiBhbmdsZT49Ny41Ki0xOSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlM193YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2UzX2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NhbGVYID0gLTE7XG4gICAgICAgIH0gXG4gICAgICAgIGVsc2UgaWYoYW5nbGU8Ny41Ki0xOSAmJiBhbmdsZT49Ny41Ki0yMSkge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlNF93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2U0X2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NhbGVYID0gLTE7XG4gICAgICAgIH0gXG4gICAgICAgIGVsc2UgaWYoYW5nbGU8Ny41Ki0yMSAmJiBhbmdsZT49Ny41Ki0yMykge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNlNV93YWxrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFjdFR5cGUgPT0gXCJzYVwiKSB7XG4gICAgICAgICAgICAgICAgYWN0TmFtZSA9IFwic2U1X2F0dGFja1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2NhbGVYID0gLTE7XG4gICAgICAgIH0gXG4gICAgICAgIGVsc2UgaWYoYW5nbGU8Ny41Ki0yMykge1xuICAgICAgICAgICAgaWYoYWN0VHlwZSA9PSBcIm1vdmVcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNfd2Fsa1wiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZihhY3RUeXBlID09IFwic2FcIikge1xuICAgICAgICAgICAgICAgIGFjdE5hbWUgPSBcInNfYXR0YWNrXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzY2FsZVggPSAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCItLS0tLS06XCIrYW5nbGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgYWN0TmFtZSA9IHRoaXMucm9sZSArXCJfXCIrIGFjdE5hbWU7XG5cbiAgICAgICAgcmV0LmFjdE5hbWUgPSBhY3ROYW1lO1xuICAgICAgICByZXQuc2NhbGVYID0gc2NhbGVYO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH0sXG5cbiAgICAvLyB1cGRhdGUgKGR0KSB7fSxcbn0pO1xuIl19