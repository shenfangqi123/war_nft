{"version":3,"sources":["assets/scripts/LightmanSprite.js"],"names":["mySprite","require","cc","Class","properties","role","start","layoutOp","node","parent","getComponent","getAttackDistance","agent","attactDistance","size","esize","playAni","agentFuture","isMainPlayer","tkx","enemypos","x","tky","y","playAngleAnimationNear","remove","_animation","play","shadow","destroy","blood","playEffect","p1","v2","p2","distance","sub","mag","dieStart","dieEnd","footStart","zIndex","scaleX","scaleY","footEnd","beforeKill","afterKill","frame1Evt","dispShadow","frame2Evt","frame3Evt","frame4Evt","frame5Evt","frame6Evt","frame7Evt","aFrame1Evt","attacking","aFrame2Evt","aFrame3Evt","aFrame4Evt","aFrame5Evt","aFrame6Evt"],"mappings":"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","sourceRoot":"/","sourcesContent":["var mySprite = require(\"MySprite\")\n\ncc.Class({\n    extends: mySprite,\n\n    properties: {\n        role:\"lm\",\n    },\n\n    start () {\n        this.layoutOp = this.node.parent.getComponent('Game');\n    },\n\n    getAttackDistance: function(agent) {\n        this.attactDistance = (agent.size + agent.esize)*0.5*1.2;\n        return this.attactDistance;\n    },\n\n    playAni: function(agent, agentFuture, isMainPlayer) {\n        this.tkx = agent.enemypos.x*30;\n        this.tky = agent.enemypos.y*30;\n        this.playAngleAnimationNear(agent, agentFuture, isMainPlayer);\n    },\n\n    remove: function() {\n        this._animation.play(\"dieoff1\");\n        this.shadow.destroy();\n        this.blood.destroy();\n    },\n\n    playEffect: function() {\n        // attack action will take some time while target enemy may dead, and will locate to another emeny.\n        // and the effect will show on that enemy. to avoid that, try to judge if the effect is very far away from current position.\n        var p1 = cc.v2(this.node.x, this.node.y);\n        var p2 = cc.v2(this.tkx, this.tky);\n        var distance = p1.sub(p2).mag();\n        if(distance < this.attactDistance*30*2) {\n            this.layoutOp.playEffect(\"lm\", this.tkx, this.tky);\n        }\n    },\n\n    dieStart: function() {\n    },\n\n    dieEnd: function() {\n        this._animation.play(\"footprint\");\n    },\n\n    //ske clip ske_bomb, foot print start evt\n    footStart: function() {\n        this.node.zIndex = -1;\n        this.node.scaleX = 1;\n        this.node.scaleY = 1;\n    },\n\n    footEnd: function() {\n        this.node.destroy();\n    },\n\n    //ske clip ske_bomb, called by first frame of ske_bomb\n    beforeKill: function() {\n        //this.shadow.destroy();\n    },\n\n    //ske clip ske_bomb, called by last frame of ske_bomb\n    afterKill: function() {\n        this.node.destroy();\n    },\n\n    frame1Evt: function() {\n        this.dispShadow(1);\n    },\n\n    frame2Evt: function() {\n        this.dispShadow(2);\n    },\n\n    frame3Evt: function() {\n        this.dispShadow(3);\n    },\n\n    frame4Evt: function() {\n        this.dispShadow(4);\n    },\n\n    frame5Evt: function() {\n        this.dispShadow(5);\n    },\n\n    frame6Evt: function() {\n        this.dispShadow(6);\n    },\n\n    frame7Evt: function() {\n        this.dispShadow(7);\n    },\n\n    aFrame1Evt: function() {\n        this.attacking = true;\n        this.dispShadow(2);\n    },\n\n    aFrame2Evt: function() {\n    },\n\n    aFrame3Evt: function() {\n        this.dispShadow(4);\n    },\n\n    aFrame4Evt: function() {\n    },\n\n    aFrame5Evt: function() {\n    },\n\n    aFrame6Evt: function() {\n        this.dispShadow(7);\n        this.playEffect();\n\n        this.attacking = false;\n    }\n\n    // update (dt) {},\n});\n"]}